name: Motion Blur
uniforms:
  uInput:
    name: Input
    type: sampler2D
  uDirection:
    name: Direction
    type: float
    max: 1
    default: 0
  uForce:
    name: Force
    type: float
    max: 0.15
    default: 0.05
shader: |
  precision lowp float;

  varying vec2 vUv;
  uniform sampler2D uInput;
  uniform float uAmount;
  uniform float uDirection;
  uniform float uForce;

  #define SAMPLES 50.0
  #define PI 3.1415926

  vec2 rotate(vec2 p, float a) {
    return vec2(
      p.x * cos(a) + p.y * sin(a),
      p.x * sin(a) + p.y * cos(a));
  }

  void main() {
    vec4 sum = vec4(0.0);
    vec2 dir = rotate(vec2(1.0, 0.0), PI - uDirection * PI) * uForce;
    float total = 0.0;
    for (float i = -1.0; i < 1.0; i += 2.0 / SAMPLES) {
      vec2 uv = vUv + dir * i;
      if (uv.x > 0.0 && uv.y > 0.0 && uv.x < 1.0 && uv.y < 1.0) {
        sum += texture2D(uInput, uv, 0.0);
        total += 1.0;
      }
    }
    gl_FragColor = sum / total;
  }
